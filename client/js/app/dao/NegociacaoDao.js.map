{"version":3,"file":"NegociacaoDao.js","names":["NegociacaoDao","connection","negociacao","Promise","resolve","reject","request","transaction","objectStore","add","onsuccess","e","onerror","console","log","target","error","cursor","openCursor","negociacoes","atual","result","dado","value","push","Negociacao","_data","_quantidade","_valor","clear"],"sources":["../../app-es6/dao/NegociacaoDao.js"],"sourcesContent":["import { Negociacao } from \"../models/Negociacao.js\";\r\nexport class NegociacaoDao{\r\n    #connection;\r\n    #store;\r\n    constructor(connection){\r\n        this.#connection = connection;\r\n        this.#store = 'negociacoes';\r\n    }\r\n\r\n    adiciona(negociacao){\r\n        return new Promise((resolve, reject)=>{\r\n            let request = this.#connection\r\n                .transaction([this.#store], 'readwrite')\r\n                    .objectStore(this.#store)\r\n                        .add(negociacao);\r\n\r\n            request.onsuccess = e => resolve();\r\n\r\n            request.onerror = e => {\r\n                console.log(e.target.error);\r\n                reject('Não foi possível adicionar a negociação');\r\n            }\r\n        })\r\n    }\r\n\r\n    listaTodos(){\r\n\r\n        return new Promise((resolve, reject)=>{\r\n\r\n            let cursor = this.#connection\r\n                .transaction([this.#store],\"readwrite\")\r\n                    .objectStore(this.#store)\r\n                        .openCursor();\r\n\r\n            let negociacoes = [];\r\n\r\n            cursor.onsuccess = e => {\r\n                let atual = e.target.result;\r\n                if(atual) {\r\n                    let dado = atual.value;\r\n                    negociacoes.push(new Negociacao(dado._data,dado._quantidade,dado._valor));\r\n\r\n                    atual.continue();\r\n\r\n                } else {\r\n                    resolve(negociacoes)\r\n                }\r\n            }\r\n\r\n            cursor.onerror = e => {\r\n                console.log(e.target.error);\r\n                reject('Não foi possível listar as negociações');\r\n            }\r\n        })\r\n        \r\n    }\r\n\r\n    apagaTodos(){\r\n        return new Promise((resolve,reject) => {\r\n            let request = this.#connection\r\n                .transaction([this.#store],\"readwrite\")\r\n                    .objectStore(this.#store)\r\n                        .clear()\r\n            \r\n            request.onsuccess = e => resolve('Negociações removidas com sucesso');\r\n\r\n            request.onerror = e => {\r\n                console.log(e.target.error)\r\n                reject('Não foi possível remover as negociações')\r\n            };\r\n        })\r\n    }\r\n}"],"mappings":";;;;;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;IACaA,a;EAGT,uBAAYC,UAAZ,EAAuB;IAAA;;IAAA;MAAA;MAAA;IAAA;;IAAA;MAAA;MAAA;IAAA;;IACnB,yCAAmBA,UAAnB;;IACA,oCAAc,aAAd;EACH;;;;WAED,kBAASC,UAAT,EAAoB;MAAA;;MAChB,OAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAmB;QAClC,IAAIC,OAAO,GAAG,2BAAI,cAAJ,CACTC,WADS,CACG,uBAAC,KAAD,UADH,EACkB,WADlB,EAELC,WAFK,uBAEO,KAFP,WAGDC,GAHC,CAGGP,UAHH,CAAd;;QAKAI,OAAO,CAACI,SAAR,GAAoB,UAAAC,CAAC;UAAA,OAAIP,OAAO,EAAX;QAAA,CAArB;;QAEAE,OAAO,CAACM,OAAR,GAAkB,UAAAD,CAAC,EAAI;UACnBE,OAAO,CAACC,GAAR,CAAYH,CAAC,CAACI,MAAF,CAASC,KAArB;UACAX,MAAM,CAAC,yCAAD,CAAN;QACH,CAHD;MAIH,CAZM,CAAP;IAaH;;;WAED,sBAAY;MAAA;;MAER,OAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAmB;QAElC,IAAIY,MAAM,GAAG,4BAAI,cAAJ,CACRV,WADQ,CACI,uBAAC,MAAD,UADJ,EACkB,WADlB,EAEJC,WAFI,uBAEQ,MAFR,WAGAU,UAHA,EAAb;;QAKA,IAAIC,WAAW,GAAG,EAAlB;;QAEAF,MAAM,CAACP,SAAP,GAAmB,UAAAC,CAAC,EAAI;UACpB,IAAIS,KAAK,GAAGT,CAAC,CAACI,MAAF,CAASM,MAArB;;UACA,IAAGD,KAAH,EAAU;YACN,IAAIE,IAAI,GAAGF,KAAK,CAACG,KAAjB;YACAJ,WAAW,CAACK,IAAZ,CAAiB,IAAIC,sBAAJ,CAAeH,IAAI,CAACI,KAApB,EAA0BJ,IAAI,CAACK,WAA/B,EAA2CL,IAAI,CAACM,MAAhD,CAAjB;YAEAR,KAAK,YAAL;UAEH,CAND,MAMO;YACHhB,OAAO,CAACe,WAAD,CAAP;UACH;QACJ,CAXD;;QAaAF,MAAM,CAACL,OAAP,GAAiB,UAAAD,CAAC,EAAI;UAClBE,OAAO,CAACC,GAAR,CAAYH,CAAC,CAACI,MAAF,CAASC,KAArB;UACAX,MAAM,CAAC,wCAAD,CAAN;QACH,CAHD;MAIH,CA1BM,CAAP;IA4BH;;;WAED,sBAAY;MAAA;;MACR,OAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAASC,MAAT,EAAoB;QACnC,IAAIC,OAAO,GAAG,4BAAI,cAAJ,CACTC,WADS,CACG,uBAAC,MAAD,UADH,EACiB,WADjB,EAELC,WAFK,uBAEO,MAFP,WAGDqB,KAHC,EAAd;;QAKAvB,OAAO,CAACI,SAAR,GAAoB,UAAAC,CAAC;UAAA,OAAIP,OAAO,CAAC,mCAAD,CAAX;QAAA,CAArB;;QAEAE,OAAO,CAACM,OAAR,GAAkB,UAAAD,CAAC,EAAI;UACnBE,OAAO,CAACC,GAAR,CAAYH,CAAC,CAACI,MAAF,CAASC,KAArB;UACAX,MAAM,CAAC,yCAAD,CAAN;QACH,CAHD;MAIH,CAZM,CAAP;IAaH"}